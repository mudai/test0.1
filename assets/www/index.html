<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1, width=device-width" />
    <title>Hello World</title>
    <script type="text/javascript" src="js/cordova.js"></script>
    <script type="text/javascript" src="js/module/jquery-1.9.1.min.js"></script>
    <link rel="stylesheet" type="text/css" media="all" href="css/jquery.mobile-1.3.2.min.css">       
    <script type="text/javascript" src="js/module/jquery.mobile-1.3.2.min.js"></script>
    <script type="text/javascript">
      var cameraReady = false;
      document.addEventListener ("deviceready", function() {
        cameraReady = true;
      });

      function snapPicture () {
        if (!cameraReady) { alert('もう少しお待ちください'); return; }

        var options = {
          destinationType: Camera.DestinationType.FILE_URI,
          targetWidth: 150,
          targetHeight: 150
        };
      
        navigator.camera.getPicture(onSuccess, onFail, options);

        // カメラに成功した際に呼ばれるコールバック関数
        function onSuccess (imageData) {
          // 一覧ページに移動
          $.mobile.changePage("#list-page");

          // リストに撮影した写真とその日付を追加
          var img = $("<img>").attr("src", imageData);
          var datetime = new Date().toString();
          $("#photos").append($("<li>" + datetime + "</li>").append(img));
          // リストを再描画
          $("#photos").listview('refresh');
        }

        // 失敗した場合に呼ばれるコールバック関数
        function onFail (message) {
          alert ('エラーです: ' + message);
        }
      }
    </script>
  </head>
  <body> 
    <div data-role="page" id="list-page">
      <div data-role="header" data-position="fixed">
        <h1>PhoneGap入門</h1>
      </div>
    
      <ul data-role="listview" data-inset="true" id="photos">
      </ul>
    
      <div data-role="footer" data-position="fixed">  
        <div data-role="navbar">
          <ul>
            <li><a href="#list-page" class="ui-btn-active ui-state-persist">一覧</a></li>
            <li><a href="#snap-page">写真撮影</a></li>
          </ul>
        </div>
      </div>
    </div>
  
    <div data-role="page" id="snap-page">
      <div data-role="header" data-position="fixed">
        <h1>写真撮影</h1>
      </div>
      <input type="button" value="撮影を行う" onclick="snapPicture()">
      <div data-role="footer" data-position="fixed">  
        <div data-role="navbar">
          <ul>
            <li><a href="#list-page">一覧</a></li>
            <li><a href="#snap-page" class="ui-btn-active ui-state-persist">写真撮影</a></li>
          </ul>
        </div>
      </div>
    </div>
  
  </body>
  
</html>
